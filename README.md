# Ethbase
[![Gitter chat](https://badges.gitter.im/gitterHQ/gitter.png)](https://gitter.im/planet-ethereum/Lobby)

The aim of this project is to provide a mechanism for enabling smart contracts to subscribe to events emitted in other contracts. For a short description of the why and how of this project, you can refer to the [about](https://github.com/planet-ethereum/ethbase/wiki/About) wiki page.

Events are submitted to the network by [relayers](https://github.com/planet-ethereum/relay-network). To make the process trustless, relayers provide [MPT](https://github.com/ethereum/wiki/wiki/Patricia-Tree#receipts-trie) proofs that the event log they're submitting has been included in the receipts trie of a recent block (last 256 blocks).

*Note:* Ethbase is currently in a very early development and experimental stage, and is not suitable for production use.

Rinkeby: [0xababd383f1debf1434193bb4a44e7476f3a0bd2c](https://rinkeby.etherscan.io/address/0xababd383f1debf1434193bb4a44e7476f3a0bd2c)

## Usage
In the given [example](contracts/example), we have an `Emitter` contract, which emits `Transfer(uint256)` when its method is called. We want our `Subscriber` contract to update its state, whenever `Transfer` is emitted. This can be done, by subscribing to the registry, and specifying the target event and the callback method that should be executed when the event is emitted. Afterwards, any [relayer](https://github.com/planet-ethereum/relay-network), upon seeing a `Transfer` event, can call `submitLog` on `Ethbase`, which would in turn invoke `Subscriber`'s specified method.

To subscribe to an event, you can create an instance of `Ethbase` and call `subscribe` in your smart contract:

```
ethbase = Ethbase(ethbase);
ethbase.subscribe(emitter, eventTopic, subscriber, method);
```

- **emitter** is the address of the contract that emits the event.
- **eventTopic** is the topic you're interested in, e.g. `keccak256("Transfer(uint256)")`.
- **subscriber** the contract that should be called when event is emitted, e.g. `this`.
- **method** the method that should be called. Method must have the same signature as the event, and generated by `bytes4(keccak256("METHOD_NAME(TYPE1,TYPE2)"))`.

## Contribute
Most of the discussions are happening in the [issues](https://github.com/planet-ethereum/ethbase/issues) and [pull requests](https://github.com/planet-ethereum/ethbase/pulls), Suggestions, contributions and critisisms are more than welcome, join in.

If you want to get involved: first of all, thanks for considering to do so! Here's how you can setup your environment:

### Requirements
Node is the only thing you need. After cloning the repository, install the dependencies, and build the contracts.

```bash
$ npm i
$ npx truffle compile
```

### Tests
To run the contracts test suite:

```bash
$ npx truffle test
```
